{{- 'template-blog.css' | asset_url | stylesheet_tag -}}
{{- 'component-card-article.css' | asset_url | stylesheet_tag -}}
<script src="{{ 'template-blog.js' | asset_url }}" defer></script>

<div class="blog-page">
  {%- if current_tags == blank or current_tags.size == 0 -%}
    {%- unless section.settings.featured_article == blank -%}
      <div>
        {%- render 'blog-featured-article',
          section: section,
          article: section.settings.featured_article,
          filters: blog.metafields.custom.filters.value
        -%}
      </div>
    {%- endunless -%}
  {%- endif -%}
  <div>
    <h1 class="h3 mb-40">{{ blog.title }}</h1>
    <tag-filter class="d--flex gap-10 mb-60 text--no-wrap overflow-auto" style="width: calc(100% + var(--page-gutter));">
      <a
        href="{{ blog.url }}"
        class="button{% if current_tags == blank or current_tags.size == 0 %} button--black{% else %} button--text{% endif %}"
      >
        {{- 'templates.blog.all_tags' | t -}}
      </a>
      {%- for tag in blog.metafields.custom.filters.value -%}
        {%- if blog.all_tags contains tag -%}
          {% if current_tags contains tag -%}
            <a class="button button--black" href="{{ blog.url }}">{{ tag }}</a>
          {%- else -%}
            <a class="button button--text" href="{{ blog.url }}/tagged/{{ tag | handle}}">{{ tag }}</a>
          {%- endif %}
        {%- endif -%}
      {%- endfor -%}
    </tag-filter>
  </div>
  <div class="d--flex flex-column">
    {%- paginate blog.articles by 10 -%}
      <div class="d--flex gap-30 mb-40 flex-column lg-up--flex-row flex-wrap--wrap">
        {%- for article in blog.articles -%}
          {%- render 'component-card-article',
            filters: blog.metafields.custom.filters.value,
            article: article,
            section: section
          -%}
        {%- endfor -%}
      </div>
      {%- if paginate.pages > 1 -%}
        {%- render 'component-pagination', paginate: paginate -%}
      {%- endif -%}
    {%- endpaginate -%}
  </div>
</div>
{% schema %}
{
  "name": "Blog Page",
  "tag": "section",
  "class": "page-width page-section page-top--pad",
  "settings": [
    {
      "type": "article",
      "id": "featured_article",
      "label": "Featured Article"
    }
  ]
}
{% endschema %}
