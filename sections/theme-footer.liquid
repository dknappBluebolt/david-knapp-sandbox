{%- capture socialLinks -%}
  <h3 class="footer-title text--lg text--bold mb-20">{{ section.settings.social_heading }}</h3>
  <nav class="social-links d--flex gap-30">
    <a href="{{ shop.brand.metafields.social_links.facebook.value }}" aria-label="Follow us on Facebook, opens a new window" target="_blank" rel="noopener">
      {%- render 'icons-sprite-icon', id: 'icon-facebook', size: 30 -%}
    </a>
    <a href="{{ shop.brand.metafields.social_links.youtube.value }}" aria-label="Follow us on YouTube, opens a new window" target="_blank" rel="noopener">
      {%- render 'icons-sprite-icon', id: 'icon-youtube', size: 30 -%}
    </a>
    <a href="{{ shop.brand.metafields.social_links.instagram.value }}" aria-label="Follow us on Instagram, opens a new window" target="_blank" rel="noopener">
      {%- render 'icons-sprite-icon', id: 'icon-instagram', size: 30 -%}
    </a>
    <a href="{{ shop.brand.metafields.social_links.pinterest.value }}" aria-label="Follow us on Pinterest, opens a new window" target="_blank" rel="noopener">
      {%- render 'icons-sprite-icon', id: 'icon-pinterest', size: 30 -%}
    </a>
  </nav>
{%- endcapture -%}

<div class="theme-footer-main color--white bg-color--black round--bottom--lg page-section--md overflow-hidden">
  <div class="grid grid--no-gutter">
    <div class="footer-sidebar d--flex flex-column lg-up--33 xl--30">
      <div class="footer-column-top flex-grow">
        <img class="footer-logo d--block mb-30" srcset="{{ section.settings.logo | image_url: width: 320 }} 320w, {{ section.settings.logo | image_url: width: 640 }} 640w" sizes="(max-width: 767px) 268px, 320px" width="300" height="{{ 300 | divided_by: section.settings.logo.aspect_ratio | round }}" alt="{{ section.settings.logo.alt | escape }}" loading="lazy">
        <p class="footer-about">{{ section.settings.about }}</p>
      </div>
      <div class="footer-column-bottom mt-40 lg-down--hide">
        {{- socialLinks -}}
      </div>
    </div>
    <div class="footer-main lg-up--67 xl--70 width--100">
      <div class="footer-column-top d--flex sm--flex-column justify--space-between flex-wrap--wrap gap-30">
        {%- for block in section.blocks -%}
          <details class="footer-nav flex-1 sm--100" open>
            <summary class="footer-title text--lg text--bold flex-between">
              {{- block.settings.heading -}}
              {%- render 'icons-sprite-icon', id: 'icon-arrow-down', class: 'md-up--hide', size: 16 -%}
            </summary>
            <nav id="footer-nav-{{ block.id }}" class="footer-nav__nav v-stack gap-16">
              {%- if block.type == 'contact' -%}
                {%- if block.settings.phone_text_1 != blank and block.settings.phone_link_1 != blank -%}
                  <a class="d--flex gap-6 text--no-wrap text--sm" href="{{ block.settings.phone_link_1 }}">
                    {%- render 'icons-sprite-icon', id: 'icon-phone', size: 20 -%}
                    <span class="hover-underline">
                      {{- block.settings.phone_text_1 -}}
                    </span>
                  </a>
                {%- endif -%}
                {%- if block.settings.phone_text_2 != blank and block.settings.phone_link_2 != blank -%}
                  <a class="d--flex gap-6 text--no-wrap text--sm" href="{{ block.settings.phone_link_2 }}">
                    {%- render 'icons-sprite-icon', id: 'icon-phone', size: 20 -%}
                    <span class="hover-underline">
                      {{- block.settings.phone_text_2 -}}
                    </span>
                  </a>
                {%- endif -%}
                {%- if block.settings.chat_text != blank -%}
                    <button class="d--flex gap-6 text--no-wrap text--sm" onclick="zE('webWidget', 'open');" aria-label="{{ block.settings.chat_text | escape }}, open chat widget" aria-haspopup="true">
                      {%- render 'icon-chat', size: 20 -%}
                      <span class="hover-underline">
                        {{- block.settings.chat_text -}}
                      </span>
                    </button>
                {%- endif -%}
                {%- if block.settings.email_text != blank and block.settings.email_link != blank -%}
                  <a class="d--flex gap-6 text--no-wrap text--sm" href="{{ block.settings.email_link }}">
                    {%- render 'icons-sprite-icon', id: 'icon-email', size: 20 -%}
                    <span class="hover-underline">
                      {{- block.settings.email_text -}}
                    </span>
                  </a>
                {%- endif -%}
              {%- else -%}
                {%- for link in block.settings.menu.links -%}
                  <a class="text--sm" href="{{ link.url }}">
                    <span class="hover-underline">
                      {{- link.title -}}
                    </span>
                  </a>
                {%- endfor -%}
              {%- endif -%}
            </nav>
          </details>
        {%- endfor -%}
      </div>
      <div class="footer-column-bottom d--flex md-up--space-between flex-wrap--wrap gap-40 mt-40">
        <div class="footer-members d--flex align-items--start sm--justify-center gap-40">
          {%- if section.settings.logo_member_1 != blank -%}
            {%- liquid assign w1 = section.settings.logo_member_width_1
            assign w1_2x = w1 | times: 2 -%}
            <img srcset="{{ section.settings.logo_member_1 | image_url: width: w1 }} {{ w1 }}w, {{ section.settings.logo_member_1 | image_url: width: w1_2x }} {{ w1_2x }}w" sizes="{{ w1 }}px" width="{{ w1 }}" height="{{ w1 | divided_by: section.settings.logo_member_1.aspect_ratio | round }}" alt="{{ section.settings.logo_member_1.alt | escape }}" loading="lazy">
          {%- endif -%}
          {%- if section.settings.logo_member_2 != blank -%}
            {%- liquid assign w2 = section.settings.logo_member_width_2
            assign w2_2x = w2 | times: 2 -%}
            <img srcset="{{ section.settings.logo_member_2 | image_url: width: w2 }} {{ w2 }}w, {{ section.settings.logo_member_2 | image_url: width: w2_2x }} {{ w2_2x }}w" sizes="{{ w2 }}px" width="{{ w2 }}" height="{{ w2 | divided_by: section.settings.logo_member_2.aspect_ratio | round }}" alt="{{ section.settings.logo_member_2.alt | escape }}" loading="lazy">
          {%- endif -%}
        </div>
        <div class="footer-email-signup lg--100 sm--100 flex-grow">
          <h3 class="footer-title text--lg text--bold">{{ section.settings.email_heading }}</h3>
          {%- if section.settings.email_text != blank -%}
            <div class="mb-20 links-underline">
              {{- section.settings.email_text -}}
            </div>
          {%- endif -%}
          {%- if section.settings.klaviyo_code != blank -%}
            {{- section.settings.klaviyo_code -}}
          {%- else -%}
            {%- form 'customer', class: "footer-email-form d--flex xs--flex-column gap-16" -%}
              {%- if form.posted_successfully? -%}
              <div class="section-header form-msg form-msg--success width--100" autofocus aria-live="polite" role="alert">
                <div class="text--bold text--sm pretitle">
                  {{- 'layout.footer.email_success_pretitle' | t -}}
                </div>
                <h3 class="h4 m-0">
                  {{- 'layout.footer.email_success_title' | t -}}
                </h3>
                <div class="rte">
                  {{- section.settings.email_success -}}
                </div>
              </div>
              {%- else -%}
                {%- if form.errors -%}
                  <div class="form-msg form-msg--error width--100 mb-16" autofocus aria-live="polite" role="alert">
                    {{- form.errors | default_errors -}}
                  </div>
                {%- endif -%}
                <div class="field width--100">
                  <input id="footer-email" class="field__input" placeholder="{{ 'layout.footer.email_input_label' | t }}" type="email" name="contact[email]" required aria-required="true">
                  <label for="footer-email" class="field__label">
                    {{- 'layout.footer.email_input_label' | t -}}
                  </label>
                </div>
                <button type="submit" class="footer-email-form__button button button--primary xs--100">
                  {{- 'layout.footer.email_submit_button' | t -}}
                </button>
                <input type="hidden" name="customer[accepts_marketing]" value="true">
                {%- liquid assign marketTag = request.locale.root_url | remove: '/'
                if marketTag == ''
                  assign marketTag = 'en-us'
                endif -%}
                <input type="hidden" name="contact[tags]" value="{{ marketTag }}">
              {%- endif -%}
            {%- endform -%}
          {%- endif -%}
        </div>
      </div>
      <div class="lg-up--hide mt-30">
        {{- socialLinks -}}
      </div>
    </div>
  </div>
</div>
<aside class="footer-legal flex-between lg-down--flex-column gap-30">
  <div class="lg-up--70">
    <nav class="footer-legal d--flex sm--flex-column gap-16 mb-30">
      {%- for link in linklists.footer.links -%}
        <a class="hover-underline" href="{{ link.url }}">{{ link.title }}</a>
        {%- unless forloop.last -%}
          <span class="separator sm--hide" aria-hidden="true">|</span>
        {%- endunless -%}
      {%- endfor -%}
    </nav>
    {%- if section.settings.legal_notice != blank -%}
      <div class="color--gray-text text--sm links-underline mb-20">
        {{- section.settings.legal_notice -}}
      </div>
    {%- endif -%}
    <div class="color--gray-text text--sm">Â© {{ shop.name }} {{ 'now' | date: '%Y' }}</div>
  </div>
  <div class="footer-payments d--flex flex-wrap--wrap lg-up--justify-end gap-16 lg-up--30 lg-down--pull-top">
    {%- assign payments = 'visa,master,american_express,discover,paypal' | split: ',' -%}
    {%- for type in payments -%}
      {%- if shop.enabled_payment_types contains type -%}
        {%- assign payIcon = 'icon-cc-' | append: type | append: '.svg' -%}
        <img src="{{ payIcon | asset_url }}" width="50" height="33" alt="{{ type | replace: '_',' ' }}" style="height:33px;" loading="lazy">
      {%- endif -%}
    {%- endfor -%}
    <img src="{{ 'icon-cc-affirm.png' | asset_img_url: '50x' }}" width="50" height="33" style="height:33px;" alt="Pay over time with Affirm" loading="lazy">
  </div>
</aside>

{% schema %}
{
  "name": "Footer",
  "class": "page-width page-width--full",
  "max_blocks": 4,
  "settings": [
    {
      "type": "textarea",
      "id": "about",
      "label": "About The Brand"
    },
    {
      "type": "text",
      "id": "social_heading",
      "label": "Social Heading"
    },
    {
      "type": "text",
      "id": "email_heading",
      "label": "Email Signup Heading"
    },
    {
      "type": "richtext",
      "id": "email_text",
      "label": "Email Signup Text"
    },
    {
      "type": "richtext",
      "id": "email_success",
      "label": "Email Signup Success Message",
      "default": "<p>Be sure to check your inbox for our emails.<\/p>"
    },
    {
      "type": "html",
      "id": "klaviyo_code",
      "label": "Klaviyo Form Embed Code"
    },
    {
      "type": "header",
      "content": "Logos"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "TCG Logo"
    },
    {
      "type": "image_picker",
      "id": "logo_member_1",
      "label": "Member Logo 1"
    },
    {
      "type": "number",
      "id": "logo_member_width_1",
      "label": "Member Logo 1 Width",
      "default": 120
    },
    {
      "type": "image_picker",
      "id": "logo_member_2",
      "label": "Member Logo 2"
    },
    {
      "type": "number",
      "id": "logo_member_width_2",
      "label": "Member Logo 2 Width",
      "default": 120
    },
    {
      "type": "richtext",
      "id": "legal_notice",
      "label": "Legal Notice"
    }
  ],
  "blocks": [
    {
      "type": "menu",
      "name": "Menu",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "link_list",
          "id": "menu",
          "label": "Menu",
          "info": "Displays only top-level menu items."
        }
      ]
    },
    {
      "type": "contact",
      "name": "Contact Info",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "header",
          "content": "Phone Link 1"
        },
        {
          "type": "text",
          "id": "phone_text_1",
          "label": "Phone 1 Link Text"
        },
        {
          "type": "text",
          "id": "phone_link_1",
          "label": "Phone 1 Link"
        },
        {
          "type": "header",
          "content": "Phone Link 2"
        },
        {
          "type": "text",
          "id": "phone_text_2",
          "label": "Phone 2 Link Text"
        },
        {
          "type": "text",
          "id": "phone_link_2",
          "label": "Phone 2 Link"
        },
        {
          "type": "header",
          "content": "Chat Link"
        },
        {
          "type": "text",
          "id": "chat_text",
          "label": "Chat Link Text"
        },
        {
          "type": "header",
          "content": "Email Link"
        },
        {
          "type": "text",
          "id": "email_link",
          "label": "Email Link"
        },
        {
          "type": "text",
          "id": "email_text",
          "label": "Email Link Text"
        }
      ]
    }
  ]
}
{% endschema %}
